% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_sir_model.R
\name{fit_sir_model}
\alias{fit_sir_model}
\title{Fit an SIR model to incidence data via likelihood}
\usage{
fit_sir_model(
  x,
  distr = c("negbin", "poisson"),
  init = list(I = 10, N = 1e+06),
  ...
)
}
\arguments{
\item{x}{Numeric vector of observed daily incidence counts (non-negative).}

\item{distr}{Character. Observation model / likelihood. One of
\code{"negbin"} or \code{"poisson"}.}

\item{init}{Named list with initial conditions and scale. Must include:
\describe{
\item{\code{I}}{Initial number of infectious individuals at day 0.}
\item{\code{N}}{Total population size used to set \eqn{S(0) = N - I(0)}.}
}
The initial state vector is \code{c(S = N - I, I = I, R = 0, C = I)}.}

\item{...}{Reserved for future extensions (currently unused).}
}
\value{
A named numeric vector with the maximum likelihood estimates:
\describe{
\item{\code{beta}}{Estimated transmission rate (per day).}
\item{\code{gamma}}{Estimated recovery/removal rate (per day).}
}
}
\description{
Estimates the transmission rate (\eqn{\beta}) and recovery/removal rate
(\eqn{\gamma}) of a deterministic SIR model by fitting the model-implied daily
incidence to observed incidence counts using maximum likelihood.

The SIR dynamics are solved numerically with \code{deSolve::ode()} (method
\code{"lsoda"}). The model uses an auxiliary cumulative-infections state
\eqn{C(t)} whose daily increments \eqn{\Delta C(t)} are matched to the observed
daily incidence series \code{x}.
}
\details{
\subsection{Model and mean incidence}{

The underlying ODE system is defined in \code{\link{sir}} and includes the
auxiliary variable \eqn{C(t)} with \eqn{dC/dt = \lambda(t)}. The expected
daily incidence is computed as:
\deqn{\mu_t = C(t) - C(t-1), \quad t = 2,\ldots,T}
In practice, \code{mu} is obtained with \code{diff(C)} on the ODE solution.

A small positive floor (\code{eps = 1e-8}) is applied to \code{mu} to avoid
non-finite log-likelihood values when \eqn{\mu_t \le 0}.
}

\subsection{Observation model (likelihood)}{

The observation distribution is selected with \code{distr}:
\describe{
\item{\code{"poisson"}}{Poisson likelihood:
\eqn{X_t \sim \mathrm{Poisson}(\mu_t)}.}
\item{\code{"negbin"}}{Negative binomial likelihood (overdispersed counts):
\eqn{X_t \sim \mathrm{NegBin}(\mu_t, size)} using
\code{stats::dnbinom(mu = mu, size = 10)} (fixed dispersion in this implementation).}
}
}

\subsection{Optimization}{

Parameters \eqn{(\beta,\gamma)} are estimated by minimizing the negative log-likelihood
using \code{optim(method = "L-BFGS-B")} with non-negativity bounds.

To reduce sensitivity to local minima, the function performs a simple multi-start
scan: it draws \code{n} random initial points for \eqn{\beta} and \eqn{\gamma}
within user-defined ranges and keeps the best solution as the starting point for
the final optimization.
}
}
\examples{
# Simulate data and fit the model
sim <- simulate_epi(n_days = 200, model = "sir", N = 1e6,
                    beta = 0.30, gamma = 0.10, rho = 1,
                    obs = "negbin", size = 20, seed = 1)
x <- sim$incidence_obs$inc

fit_pois <- fit_sir_model(x, distr = "poisson", init = list(I = 10, N = 1e6))
fit_nb   <- fit_sir_model(x, distr = "negbin",  init = list(I = 10, N = 1e6))

fit_pois
fit_nb

}
\seealso{
\code{\link{sir}}, \code{\link{simulate_epi}}
}
