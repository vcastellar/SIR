% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metrics.R
\name{instantaneous_growth_rate}
\alias{instantaneous_growth_rate}
\title{Instantaneous growth rate}
\usage{
instantaneous_growth_rate(sim, window = 1, offset = 0.5)
}
\arguments{
\item{sim}{An object of class \code{"sim_epi"}.}

\item{window}{Integer. Size of the moving average window (must be odd for
centered smoothing). Default is 1 (no smoothing).}

\item{offset}{Numeric. Small constant added to incidence to avoid \code{log(0)}.}
}
\value{
A data.frame with columns \code{time} and \code{r}.
}
\description{
Computes the time-varying exponential growth rate of the epidemic, with
optional smoothing via a moving average to reduce noise.
}
\details{
The instantaneous growth rate is calculated as the derivative of the
log-incidence. To handle noise, a moving average of size \code{window}
is applied to the incidence before the transformation:
\deqn{
\lambda_{smooth}(t) = \frac{1}{k} \sum_{j=-(k-1)/2}^{(k-1)/2} \lambda(t+j)
}
where \eqn{k} is the window size. The growth rate is then:
\deqn{
r(t_i) \approx \frac{\log \lambda_{smooth}(t_{i+1}) - \log \lambda_{smooth}(t_i)}{t_{i+1} - t_i}
}
}
\examples{
sim <- simulate_epi(
  model = SI_MODEL,
  times = 0:50,
  parms = c(beta = 0.4),
  init  = c(S = 999, I = 1)
)
# Sin suavizado
plot(instantaneous_growth_rate(sim, window = 1))

# Con suavizado (ventana de 7 dÃ­as)
plot(instantaneous_growth_rate(sim, window = 7))

}
