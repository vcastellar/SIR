% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_sir.R
\name{simulate_sir}
\alias{simulate_sir}
\title{Simulate an SIR epidemic and generate observed incidence}
\usage{
simulate_sir(
  n_days = 200,
  N = 1e+06,
  beta = 0.35,
  gamma = 0.1,
  I0 = 10,
  R0 = 0,
  rho = 0.3,
  obs = c("poisson", "negbin"),
  size = 20,
  seed = NULL
)
}
\arguments{
\item{n_days}{Integer. Number of days to simulate (output will include day 0 to
day \code{n_days}).}

\item{N}{Numeric. Total population size.}

\item{beta}{Numeric. Transmission rate (per day).}

\item{gamma}{Numeric. Recovery/removal rate (per day).}

\item{I0}{Numeric. Initial number of infectious individuals at day 0.}

\item{R0}{Numeric. Initial number of removed/recovered individuals at day 0.}

\item{rho}{Numeric in \eqn{[0, 1]}. Reporting fraction mapping true incidence to
expected observed cases.}

\item{obs}{Character. Observation model for reported incidence. Either
\code{"poisson"} or \code{"negbin"}.}

\item{size}{Numeric. Dispersion (size) parameter for the negative binomial
observation model. Larger values imply less overdispersion.}

\item{seed}{Optional integer. If provided, sets the random seed for reproducible
observation draws.}
}
\value{
A named list with:
\describe{
\item{params}{A list with the simulation parameters used.}
\item{states}{A data frame with columns \code{time}, \code{S}, \code{I},
\code{R}, and \code{C} (cumulative infections).}
\item{incidence_true}{A data frame with columns \code{time} and \code{inc}
(latent incidence \eqn{\lambda(t)}).}
\item{incidence_obs}{A data frame with columns \code{time} and \code{inc}
(reported incidence sampled from the observation model).}
\item{cumulative_obs}{A data frame with columns \code{time} and
\code{cases_cum} (cumulative reported cases).}
}
}
\description{
Simulates a deterministic SIR model (solved as an ODE system) and produces both
the latent epidemic trajectories and a simple observation process for reported
cases. The model is extended with an auxiliary compartment \eqn{C(t)} that
tracks the cumulative number of infections via the incidence (force of infection).
}
\details{
\subsection{Model}{

The SIR dynamics are:
\deqn{\frac{dS}{dt} = -\lambda(t)}
\deqn{\frac{dI}{dt} = \lambda(t) - \gamma I(t)}
\deqn{\frac{dR}{dt} = \gamma I(t)}
where the incidence \eqn{\lambda(t)} (new infections per day) is defined as:
\deqn{\lambda(t) = \beta \frac{S(t) I(t)}{N}}
with \eqn{N = S(t) + I(t) + R(t)}.

To provide a cumulative infection curve, the model includes:
\deqn{\frac{dC}{dt} = \lambda(t)}
so that \eqn{C(t)} accumulates infections over time (continuous-time analogue
of cumulative incidence).
}

\subsection{Observation model}{

The function converts the latent incidence \eqn{\lambda(t)} into reported counts
using a reporting fraction \eqn{\rho}:
\deqn{\mu(t) = \rho \lambda(t)}
and then samples:
\itemize{
\item \code{obs = "poisson"}: \eqn{Y(t) \sim \mathrm{Poisson}(\mu(t))}
\item \code{obs = "negbin"}: \eqn{Y(t) \sim \mathrm{NegBin}(\mu(t), size)}
}

The observed cumulative cases are computed as \code{cumsum(inc_obs)}.
}
}
\examples{
sim <- simulate_sir(
  n_days = 300,
  N = 1e6,
  beta = 0.30,
  gamma = 0.10,
  I0 = 20,
  rho = 0.25,
  obs = "negbin",
  size = 15,
  seed = 1
)

head(sim$incidence_obs)
head(sim$cumulative_obs)

sim$states$I

plot(sim$states$time, sim$states$I, type = "l",
     xlab = "Días", ylab = "I(t) (infectados activos)", main = "SIR: infectados activos")

plot(sim$incidence_obs$time, sim$incidence_obs$inc, type = "h",
     xlab = "Días", ylab = "Incidencia observada", main = "Incidencia observada (conteos)")

}
