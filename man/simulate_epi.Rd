% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_epi.R
\name{simulate_epi}
\alias{simulate_epi}
\title{Simulate an epidemic model defined by an \code{epi_model} object}
\usage{
simulate_epi(model, times, time_unit = "days", parms, init, seed = NULL, ...)
}
\arguments{
\item{model}{An object of class \code{"epi_model"} defining the epidemic model
to simulate.}

\item{times}{Numeric vector of time points at which to solve the ODE system.
Must be strictly increasing and of length >= 2. The first value typically
corresponds to the initial time (e.g. \code{0}).}

\item{time_unit}{Character string specifying the unit of time associated
with \code{times}. One of \code{"days"}, \code{"weeks"}, \code{"month"},
or \code{"year"}. This is used only for printing and plotting labels and
does not affect the numerical simulation.}

\item{parms}{Named numeric vector of model parameters. Names must match
\code{model$par_names}. Any missing parameters are taken from
\code{model$defaults}, if available.}

\item{init}{Named numeric vector giving the initial values of the state
variables. Names must exactly match \code{model$states}. If not provided,
\code{model$init} must be defined.}

\item{seed}{Optional integer. If provided, sets the random seed. This argument
is included for consistency with other functions but does not affect the
deterministic ODE solution.}

\item{...}{Additional arguments passed directly to
\code{\link[deSolve]{ode}}, such as \code{method}, \code{rtol}, or \code{atol}.}
}
\value{
An object of class \code{"sim_epi"}, containing:
\describe{
\item{model}{The \code{epi_model} object used to generate the simulation.}
\item{params}{A list of model parameter values used in the simulation.}
\item{states}{A data frame with columns \code{time} and the model state
variables, containing the simulated state trajectories.}
\item{flows}{A data frame with columns \code{time} and the declared model
flows, or \code{NULL} if the model defines no flows.}
\item{time_unit}{Character string giving the time unit associated with
the simulation.}
}
}
\description{
Simulates a deterministic compartmental epidemic model specified via an
\code{\link{epi_model}} object. The model is solved as a system of ordinary
differential equations (ODEs) using \code{\link[deSolve]{ode}}.

The function is fully model-agnostic: all model-specific information
(state variables, parameters, default values, ODE right-hand side, and
optional flow definitions) is read directly from the supplied
\code{epi_model}.
}
\details{
\subsection{Model structure}{

The \code{model} argument must be an object of class \code{"epi_model"},
typically created with \code{\link{new_epi_model}}. At minimum, the model
must define:
\itemize{
\item an ODE right-hand side function (\code{model$rhs});
\item the state variables (\code{model$states});
\item the model parameters (\code{model$par_names}).
}

Optionally, the model may declare one or more flows via \code{model$flows}.
If present, these flows must be returned by the ODE right-hand side function
as additional named flows and will be extracted into the simulation result.

No assumptions are made about the semantic meaning of states or flows
(e.g. incidence, prevalence, cumulative counts).
}

\subsection{Time grid}{

The model is simulated at the time points specified by the numeric vector
\code{times}. This vector must be strictly increasing and of length >= 2.
The first value typically corresponds to the initial time (e.g. \code{0}).

This design follows the interface of \code{\link[deSolve]{ode}} and provides
full control over the temporal resolution of the simulation, including
irregular or non-integer time grids.
}

\subsection{Parameters}{

Model parameters are provided via the named numeric vector \code{parms}.
Names must match \code{model$par_names}. If the model defines default
parameter values in \code{model$defaults}, these are used as a baseline and
may be partially overridden by \code{parms}. All parameters must be fully
specified either via \code{parms} or \code{model$defaults}.
}

\subsection{Initial conditions}{

The initial state \code{init} must be supplied as a named numeric vector
whose names exactly match \code{model$states}. If \code{init} is not provided,
the model must define default initial conditions in \code{model$init}.

No automatic construction of initial conditions is performed.
}

\subsection{Numerical integration}{

The ODE system is solved using \code{\link[deSolve]{ode}}. Additional arguments
passed via \code{...} are forwarded directly to \code{deSolve::ode()}, allowing
full control over the numerical integration. In particular, the integration
method can be specified using the \code{method} argument.

If \code{method} is not supplied, \code{deSolve::ode()} uses its default
integration method (typically \code{"lsoda"}).
}
}
\examples{
## ------------------------------------------------------------------
## Example 1: SIR model
## ------------------------------------------------------------------

sim <- simulate_epi(
  model = SIR_MODEL,
  times = 0:200,
  time_unit = "week",
  parms = c(beta = 0.30, gamma = 0.10),
  init  = SIR_MODEL$init,
  method = "lsoda"
)

plot(sim)


## ------------------------------------------------------------------
## Example 2: Using a different numerical integration method
## ------------------------------------------------------------------

sim <- simulate_epi(
  model = SIR_MODEL,
  times = 0:200,
  parms = c(beta = 0.30, gamma = 0.10),
  init  = c(S = 1e6 - 10, I = 10, R = 0),
  method = "rk4"
)

plot(sim)


## ------------------------------------------------------------------
## Example 3: Model without flows
## ------------------------------------------------------------------

sim <- simulate_epi(
  model = SI_MODEL,
  times = 30:100,
  parms = c(beta = 0.25),
  init  = c(S = 999, I = 1)
)

plot(sim)

}
\seealso{
\code{\link{new_epi_model}}, \code{\link[deSolve]{ode}},
\code{\link{plot.sim_epi}}, \code{\link{print.sim_epi}}
}
