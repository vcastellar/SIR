% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metodos.R
\name{plot.sim_epi}
\alias{plot.sim_epi}
\title{Plot a simulated epidemic}
\usage{
\method{plot}{sim_epi}(x, what = "states", scale = c("auto", "full", "small", "log"), ...)
}
\arguments{
\item{x}{Object of class \code{"sim_epi"} as returned by
\code{\link{simulate_epi}}.}

\item{what}{Character string specifying what to plot. One of:
\code{"states"} (all state variables),
\code{"incidence"} (observed incidence counts),
or the name of a single model output declared in
\code{x$model$outputs} (e.g. \code{"I"}, \code{"S"}).}

\item{scale}{Character string specifying the scale for state plots.
One of \code{"auto"}, \code{"full"}, \code{"small"}, or \code{"log"}.
This argument is only used when \code{what = "states"}.}

\item{...}{Additional graphical parameters passed to base plotting
functions such as \code{\link{plot}} and \code{\link{matplot}}.}
}
\value{
Invisibly returns the input object \code{x}.
}
\description{
Plot method for objects of class \code{"sim_epi"} as returned by
\code{\link{simulate_epi}}. The function provides a flexible visualization
interface for simulated epidemic trajectories by allowing the user to plot
either all model states, the observed incidence time series, or a single
model-defined output.

Unlike earlier versions, this method does not assume a specific
compartmental structure (e.g. SIR or SEIR). All available quantities that can
be plotted are taken directly from the outputs declared in the underlying
\code{\link{epi_model}} used to generate the simulation.
}
\details{
The behavior of the function depends on the value of the \code{what} argument:

\itemize{
\item{\code{what = "states"}}{Plots the time evolution of all state variables
defined in \code{x$model$states}, using the simulated trajectories
stored in \code{x$states}. The time variable is taken from the
\code{time} column of \code{x$states} and is not considered a state.}

\item{\code{what = "incidence"}}{Plots the observed incidence counts generated
by the observation model and stored in \code{x$incidence}. If no observation
model was specified during simulation (i.e. \code{obs = "none"}), this
option results in an error.}

\item{\code{what = <output>}}{Plots a single model-defined output, where
\code{<output>} is the name of one of the quantities declared in
\code{x$model$outputs} (e.g. \code{"I"}, \code{"S"}, \code{"R"},
or \code{"incidence"}). The corresponding trajectory is extracted from
\code{x$states}.}
}

If available, the time unit stored in the \code{sim_epi} object
(i.e. \code{x$time_unit}) is used to label the time axis. This affects only the
plot labels and does not change the numerical values of time.
}
\examples{
sird_rhs <- function(time, state, parms) {
  with(as.list(c(state, parms)), {
    N <- S + I + R
    lambda <- beta * S * I / N

    dS <- -lambda
    dI <-  lambda - gamma * I - mu * I
    dR <-  gamma * I
    dD <-  mu * I

    list(
      c(dS, dI, dR, dD),
      incidence = lambda
    )
  })
}

SIRD_MODEL <- epi_model(
  name      = "SIRD",
  rhs       = sird_rhs,
  states    = c("S", "I", "R", "D"),
  par_names = c("beta", "gamma", "mu"),
  roles     = list(
    susceptible = "S",
    infectious  = "I",
    recovered   = "R",
    deceased    = "D",
    incidence   = "incidence"
  )
)

# Plot observed incidence (requires an observation model)
simulate_epi(model = SIRD_MODEL,
             times = 0:200)

# Plot a single state variable
plot(sim, what = "I")

# Plot all flows
plot(sim, what = "flows")


# If the model defines Rt as a flow, it can be plotted directly
plot(sim, what = "Rt")

}
\seealso{
\code{\link{simulate_epi}}, \code{\link{summary.sim_epi}},
\code{\link{print.sim_epi}}
}
